# LaTeX 公式渲染测试指南

## 📋 测试前准备

### 1. 确认依赖已安装

```bash
cd C:\Users\Administrator\online-game\CogniGuide\CogniGuide
npm list katex remark-math rehype-katex
```

应该看到：
- katex@0.16.28
- remark-math@6.0.0
- rehype-katex@7.0.1

### 2. 启动应用

```bash
npm run dev
```

访问：http://localhost:5173

## 🧪 测试场景

### 测试 1：浏览器测试页面（最简单）

1. **打开测试页面**

```bash
# Windows
start tests/latex-test.html

# 或直接双击文件
tests/latex-test.html
```

2. **验证清单**

- [ ] 页面正常加载
- [ ] 行内公式显示：$E = mc^2$
- [ ] 块级公式显示：积分、矩阵、极限
- [ ] 特殊符号显示：希腊字母、运算符
- [ ] 点击"切换深色/浅色模式"按钮
- [ ] 深色模式下公式清晰可见
- [ ] 浅色模式下公式清晰可见

**预期结果：** 所有公式正确渲染，支持主题切换

### 测试 2：应用内对话测试

1. **启动应用并创建新对话**

2. **测试用户消息（深色背景）**

在输入框输入：
```
勾股定理公式：$a^2 + b^2 = c^2$

块级公式：
$$
c = \sqrt{a^2 + b^2}
$$
```

发送消息。

**验证：**
- [ ] 行内公式正确渲染
- [ ] 块级公式单独一行显示
- [ ] 公式在深色背景上清晰可见（浅色文字）

3. **测试 AI 回复（浅色背景）**

输入：
```
请解释二次方程的求根公式，并用 LaTeX 格式写出
```

**验证：**
- [ ] AI 回复包含 LaTeX 公式
- [ ] 公式在浅色背景上清晰可见（深色文字）
- [ ] 公式与文本混合显示正常

### 测试 3：复杂公式测试

复制以下内容到对话中：

```markdown
请解释以下数学概念：

1. 积分：$\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}$

2. 矩阵乘法：
$$
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
\begin{pmatrix}
x \\
y
\end{pmatrix}
=
\begin{pmatrix}
ax + by \\
cx + dy
\end{pmatrix}
$$

3. 泰勒级数：
$$
f(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!}(x-a)^n
$$
```

**验证：**
- [ ] 所有公式正确渲染
- [ ] 积分符号正确显示
- [ ] 矩阵格式正确
- [ ] 求和符号和无穷大符号正确

### 测试 4：公式与代码混合测试

输入：
```
展示一个计算圆面积的 Python 代码，并使用 LaTeX 说明公式
```

**验证：**
- [ ] 代码块正确高亮
- [ ] LaTeX 公式在文本中正确渲染
- [ ] 代码块中的 $ 符号不被渲染为公式

### 测试 5：错误处理测试

输入包含错误语法的 LaTeX：
```
错误的公式：$\frac{a}{ $
```

**验证：**
- [ ] 应用不崩溃
- [ ] 显示原始代码或友好错误提示
- [ ] 其他内容正常渲染

## 📊 测试结果记录

### 测试 1：浏览器测试页面

| 项目 | 状态 | 备注 |
|------|------|------|
| 页面加载 | ☐ 通过 | |
| 行内公式 | ☐ 通过 | |
| 块级公式 | ☐ 通过 | |
| 特殊符号 | ☐ 通过 | |
| 主题切换 | ☐ 通过 | |

### 测试 2：应用内对话

| 项目 | 状态 | 备注 |
|------|------|------|
| 用户消息公式 | ☐ 通过 | 深色背景 |
| AI 回复公式 | ☐ 通过 | 浅色背景 |
| 公式清晰度 | ☐ 通过 | |

### 测试 3：复杂公式

| 项目 | 状态 | 备注 |
|------|------|------|
| 积分公式 | ☐ 通过 | |
| 矩阵公式 | ☐ 通过 | |
| 泰勒级数 | ☐ 通过 | |
| 其他复杂公式 | ☐ 通过 | |

### 测试 4：混合内容

| 项目 | 状态 | 备注 |
|------|------|------|
| 公式 + 文本 | ☐ 通过 | |
| 公式 + 代码 | ☐ 通过 | |
| 公式 + 列表 | ☐ 通过 | |

### 测试 5：错误处理

| 项目 | 状态 | 备注 |
|------|------|------|
| 语法错误 | ☐ 通过 | |
| 不支持的命令 | ☐ 通过 | |
| 转义字符 | ☐ 通过 | |

## ✅ 验收标准

全部测试通过后，确认以下标准：

- [ ] 所有基础公式类型正确渲染
- [ ] 深色/浅色主题都清晰可见
- [ ] 与现有功能无冲突
- [ ] 性能表现良好（无明显卡顿）
- [ ] 错误处理友好
- [ ] 文档完整准确

## 🐛 问题反馈

如果发现问题，请记录：

### 问题描述
- 测试场景：
- 预期行为：
- 实际行为：
- 复现步骤：
- 浏览器信息：
- 错误信息（控制台）：

### 截图
- [ ] 添加问题截图
- [ ] 添加控制台错误截图

## 📝 测试完成确认

**测试人员：** _______________

**测试日期：** _______________

**测试结果：** ☐ 通过  ☐ 未通过

**备注：** _______________

---

**测试指南版本：** v1.0
**最后更新：** 2026-02-06
