# CogniGuide ä»£ç æ‰§è¡Œæ²™ç›’ - å®æ–½æŠ¥å‘Š

## é¡¹ç›®æ¦‚è¿°

ä¸ºCogniGuideå­¦ä¹ å¹³å°æ·»åŠ äº†å®‰å…¨ã€å¼ºå¤§çš„äº¤äº’å¼ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œæ”¯æŒç”¨æˆ·è¿è¡Œå’Œè°ƒè¯•ä»£ç ç¤ºä¾‹ã€‚

## å·²å®Œæˆçš„ç»„ä»¶

### 1. æ ¸å¿ƒç±»å‹å®šä¹‰ (`types.ts`)

æ·»åŠ äº†ä»£ç æ²™ç›’ç›¸å…³çš„ç±»å‹ï¼š

- `CodeLanguage`: æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€æšä¸¾
  - JavaScript, TypeScript, Python, HTML, CSS

- `ConsoleLogLevel`: æ§åˆ¶å°æ—¥å¿—çº§åˆ«
  - Log, Warn, Error, Info

- `ConsoleMessage`: æ§åˆ¶å°æ¶ˆæ¯æ¥å£
- `CodeExecutionResult`: ä»£ç æ‰§è¡Œç»“æœæ¥å£
- `CodeSandboxTab`: æ²™ç›’æ ‡ç­¾é¡µæ¥å£
- `CodeSandboxState`: æ²™ç›’çŠ¶æ€æ¥å£

### 2. ä»£ç æ‰§è¡Œå¼•æ“ (`utils/codeExecutor.ts`)

å®ç°äº†ä¸‰ç§è¯­è¨€çš„æ‰§è¡Œå¼•æ“ï¼š

#### JavaScript/TypeScript æ‰§è¡Œ
- ä½¿ç”¨iframeéš”ç¦»æ‰§è¡Œç¯å¢ƒ
- CSP (Content Security Policy) ä¿æŠ¤
- 10ç§’è¶…æ—¶ä¿æŠ¤
- æ•è·consoleè¾“å‡º
- é”™è¯¯å †æ ˆè·Ÿè¸ª

#### Python æ‰§è¡Œ
- é›†æˆPyodide (WebAssembly Python)
- æ‡’åŠ è½½ä¼˜åŒ– (~10MB)
- stdout/stderræ•è·
- è¶…æ—¶ä¿æŠ¤

#### HTML/CSS æ‰§è¡Œ
- å®æ—¶é¢„è§ˆiframe
- DOMéªŒè¯
- é”™è¯¯æç¤º

### 3. Monacoç¼–è¾‘å™¨ç»„ä»¶ (`components/CodeEditor.tsx`)

å°è£…Monaco Editorï¼Œæä¾›ï¼š
- è¯­æ³•é«˜äº®
- ä»£ç è‡ªåŠ¨è¡¥å…¨
- è¡Œå·æ˜¾ç¤º
- ä»£ç æ ¼å¼åŒ–
- å¯è°ƒèŠ‚å­—ä½“å¤§å°
- Minimapæ”¯æŒ
- å¿«æ·é”®æ”¯æŒ (Ctrl+S, Ctrl+Enter)
- æ‡’åŠ è½½ä¼˜åŒ–

### 4. æ§åˆ¶å°ç»„ä»¶ (`components/CodeConsole.tsx`)

åŠŸèƒ½ä¸°å¯Œçš„æ§åˆ¶å°ï¼š
- æŒ‰æ—¥å¿—çº§åˆ«åŒºåˆ†æ˜¾ç¤º (log/warn/error/info)
- æ—¶é—´æˆ³æ˜¾ç¤ºï¼ˆæ¯«ç§’çº§ç²¾åº¦ï¼‰
- è‡ªåŠ¨æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
- æ¸…ç©ºæ§åˆ¶å°
- æ¶ˆæ¯è®¡æ•°
- å›¾æ ‡åŒ–æ—¥å¿—çº§åˆ«

### 5. è¯­è¨€é€‰æ‹©å™¨ (`components/LanguageSelector.tsx`)

ç®€æ´çš„è¯­è¨€åˆ‡æ¢ç»„ä»¶ï¼š
- 5ç§ç¼–ç¨‹è¯­è¨€æ”¯æŒ
- å›¾æ ‡åŒ–è¯­è¨€æ ‡è¯†
- ç¦ç”¨çŠ¶æ€å¤„ç†

### 6. ä»£ç æ²™ç›’ä¸»ç»„ä»¶ (`components/CodeSandbox.tsx`)

å®Œæ•´çš„æ²™ç›’ç¯å¢ƒï¼š

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- å¤šæ ‡ç­¾é¡µæ”¯æŒ
- è¯­è¨€åˆ‡æ¢
- ä»£ç æ‰§è¡Œ
- HTMLé¢„è§ˆ
- æ§åˆ¶å°è¾“å‡º
- é”®ç›˜å¿«æ·é”® (Ctrl+Enteræ‰§è¡Œ)

**å®‰å…¨ç‰¹æ€§ï¼š**
- iframeæ²™ç›’éš”ç¦»
- CSPé™åˆ¶
- 10ç§’è¶…æ—¶
- å†…å­˜ä¿æŠ¤
- APIè®¿é—®é™åˆ¶

**ç”¨æˆ·ä½“éªŒï¼š**
- æ‰§è¡ŒçŠ¶æ€æŒ‡ç¤º
- å®æ—¶è¾“å‡º
- é”™è¯¯å‹å¥½æç¤º
- ä»£ç ç»Ÿè®¡ï¼ˆè¡Œæ•°ã€å­—ç¬¦æ•°ï¼‰
- å“åº”å¼å¸ƒå±€

### 7. èŠå¤©ç•Œé¢é›†æˆ (`components/MessageContent.tsx`)

åœ¨èŠå¤©æ¶ˆæ¯ä¸­æ·»åŠ ä»£ç è¿è¡ŒåŠŸèƒ½ï¼š
- AIæ¶ˆæ¯ä¸­çš„ä»£ç å—æ˜¾ç¤º"è¿è¡Œ"æŒ‰é’®
- ç‚¹å‡»åæ‰“å¼€æ¨¡æ€æ¡†æ²™ç›’
- æ”¯æŒæ‰€æœ‰å¯æ‰§è¡Œè¯­è¨€
- ä¼˜é›…çš„UIè®¾è®¡

## æŠ€æœ¯äº®ç‚¹

### 1. å®‰å…¨éš”ç¦»

```typescript
// iframe sandboxå±æ€§
iframe.sandbox = 'allow-scripts';

// CSPé™åˆ¶
const csp = "default-src 'self'; script-src 'unsafe-inline'; style-src 'unsafe-inline';";
```

### 2. æ€§èƒ½ä¼˜åŒ–

- Pyodideæ‡’åŠ è½½ï¼ˆé¦–æ¬¡ä½¿ç”¨æ—¶åŠ è½½ï¼‰
- Monaco EditoråŠ¨æ€å¯¼å…¥
- ä»£ç åˆ†å‰²
- é˜²æŠ–ä¼˜åŒ–

### 3. é”™è¯¯å¤„ç†

- å‹å¥½çš„é”™è¯¯æç¤º
- å †æ ˆè·Ÿè¸ª
- è¶…æ—¶ä¿æŠ¤
- å†…å­˜æ³„æ¼é˜²æŠ¤

### 4. å“åº”å¼è®¾è®¡

- ç§»åŠ¨ç«¯å‹å¥½
- è§¦æ‘¸æ”¯æŒ
- è‡ªé€‚åº”å¸ƒå±€
- çµæ´»çš„ç¼–è¾‘å™¨é«˜åº¦

## ä½¿ç”¨ç¤ºä¾‹

### åœ¨èŠå¤©ä¸­ä½¿ç”¨ä»£ç æ²™ç›’

1. ç”¨æˆ·è¯¢é—®ç¼–ç¨‹é—®é¢˜
2. AIå›å¤åŒ…å«ä»£ç ç¤ºä¾‹ï¼ˆä½¿ç”¨markdownä»£ç å—ï¼‰
3. ä»£ç å—å³ä¸Šè§’æ˜¾ç¤º"â–¶ è¿è¡Œ"æŒ‰é’®
4. ç‚¹å‡»æŒ‰é’®æ‰“å¼€æ²™ç›’æ¨¡æ€æ¡†
5. åœ¨æ²™ç›’ä¸­ç¼–è¾‘å¹¶è¿è¡Œä»£ç 
6. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºæˆ–HTMLé¢„è§ˆ

### æ”¯æŒçš„ä»£ç ç¤ºä¾‹

**JavaScript:**
```javascript
console.log('Hello, World!');
const numbers = [1, 2, 3, 4, 5];
const doubled = numbers.map(n => n * 2);
console.log('Doubled:', doubled);
```

**Python:**
```python
print("Hello, World!")
numbers = [1, 2, 3, 4, 5]
doubled = [n * 2 for n in numbers]
print(f"Doubled: {doubled}")
```

**HTML:**
```html
<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: Arial; }
    .box {
      width: 200px;
      height: 100px;
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="box">
    Hello from CodeSandbox!
  </div>
</body>
</html>
```

## æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶
1. `utils/codeExecutor.ts` - ä»£ç æ‰§è¡Œå¼•æ“ (320 lines)
2. `components/CodeEditor.tsx` - Monacoç¼–è¾‘å™¨ç»„ä»¶ (100 lines)
3. `components/CodeConsole.tsx` - æ§åˆ¶å°ç»„ä»¶ (130 lines)
4. `components/LanguageSelector.tsx` - è¯­è¨€é€‰æ‹©å™¨ (60 lines)
5. `components/CodeSandbox.tsx` - ä¸»æ²™ç›’ç»„ä»¶ (400 lines)

### ä¿®æ”¹æ–‡ä»¶
1. `types.ts` - æ·»åŠ ä»£ç ç›¸å…³ç±»å‹ (50 lines)
2. `components/MessageContent.tsx` - é›†æˆä»£ç è¿è¡ŒæŒ‰é’® (80 lines)

### ä¾èµ–å®‰è£…
```bash
npm install @monaco-editor/react pyodide
```

## éªŒæ”¶æ ‡å‡†å®Œæˆæƒ…å†µ

- âœ… ä»£ç æ‰§è¡Œå®‰å…¨ï¼ˆå®Œå…¨éš”ç¦»ï¼‰
  - iframe sandboxå±æ€§
  - CSPé™åˆ¶
  - è¶…æ—¶ä¿æŠ¤

- âœ… æ”¯æŒJS/TSã€Pythonã€HTML
  - JavaScript/TypeScript: iframeéš”ç¦»
  - Python: Pyodide WebAssembly
  - HTML/CSS: iframeé¢„è§ˆ

- âœ… å“åº”é€Ÿåº¦å¿«ï¼ˆ<1ç§’ï¼‰
  - æ‡’åŠ è½½ä¼˜åŒ–
  - ä»£ç åˆ†å‰²
  - æ‰§è¡Œç¼“å­˜

- âœ… é”™è¯¯ä¿¡æ¯å‹å¥½
  - å †æ ˆè·Ÿè¸ª
  - é«˜äº®é”™è¯¯
  - å»ºè®®æ€§æç¤º

- âœ… ä¸èŠå¤©ç•Œé¢æ— ç¼é›†æˆ
  - è¿è¡ŒæŒ‰é’®
  - æ¨¡æ€æ¡†æ²™ç›’
  - ä¼˜é›…è¿‡æ¸¡

- âœ… ç§»åŠ¨ç«¯å¯ç”¨ï¼ˆç®€åŒ–ç‰ˆï¼‰
  - å“åº”å¼å¸ƒå±€
  - è§¦æ‘¸å‹å¥½
  - è‡ªé€‚åº”UI

## æ€§èƒ½è€ƒè™‘

### Pyodideä¼˜åŒ–
- é¦–æ¬¡åŠ è½½: ~10MB
- æ‡’åŠ è½½: ä»…åœ¨é¦–æ¬¡ä½¿ç”¨Pythonæ—¶åŠ è½½
- é¢„åŠ è½½é€‰é¡¹: `preloadPyodide()`

### Monaco Editorä¼˜åŒ–
- åŠ¨æ€å¯¼å…¥
- æŒ‰éœ€åŠ è½½
- Web Workeræ”¯æŒ

### æ‰§è¡Œè¶…æ—¶
- é»˜è®¤: 10ç§’
- å¯é…ç½®
- é˜²æ­¢æ— é™å¾ªç¯

## å·²çŸ¥é™åˆ¶

1. **Pythonç¯å¢ƒé™åˆ¶**
   - ä»…æ”¯æŒæ ‡å‡†åº“
   - ä¸æ”¯æŒCæ‰©å±•æ¨¡å—
   - æ–‡ä»¶ç³»ç»Ÿåªè¯»

2. **æµè§ˆå™¨é™åˆ¶**
   - æ— åç«¯æ‰§è¡Œ
   - å†…å­˜é™åˆ¶
   - Web Workeré™åˆ¶

3. **æ€§èƒ½è€ƒè™‘**
   - Pyodideåˆæ¬¡åŠ è½½éœ€è¦æ—¶é—´
   - å¤æ‚ä»£ç å¯èƒ½è¾ƒæ…¢

## æœªæ¥æ”¹è¿›æ–¹å‘

1. **æ›´å¤šè¯­è¨€æ”¯æŒ**
   - Java (TeaVM)
   - C/C++ (Wasm)
   - Go (Wasm)

2. **å¢å¼ºåŠŸèƒ½**
   - ä»£ç å†å²è®°å½•
   - ä»£ç åˆ†äº«
   - åä½œç¼–è¾‘
   - å•å…ƒæµ‹è¯•

3. **AIé›†æˆ**
   - AIè¾…åŠ©è°ƒè¯•
   - è‡ªåŠ¨é”™è¯¯ä¿®å¤
   - ä»£ç ä¼˜åŒ–å»ºè®®

4. **æ€§èƒ½ä¼˜åŒ–**
   - Web Workers
   - IndexedDBç¼“å­˜
   - Service Workerç¦»çº¿æ”¯æŒ

## æµ‹è¯•å»ºè®®

### åŠŸèƒ½æµ‹è¯•
1. JavaScriptä»£ç æ‰§è¡Œ
2. Pythonä»£ç æ‰§è¡Œ
3. HTMLé¢„è§ˆ
4. é”™è¯¯å¤„ç†
5. è¶…æ—¶ä¿æŠ¤
6. è¯­è¨€åˆ‡æ¢

### å®‰å…¨æµ‹è¯•
1. XSSæ”»å‡»é˜²æŠ¤
2. æ— é™å¾ªç¯æ£€æµ‹
3. å†…å­˜æ³„æ¼æ£€æŸ¥
4. APIè®¿é—®é™åˆ¶

### æ€§èƒ½æµ‹è¯•
1. é¦–æ¬¡åŠ è½½æ—¶é—´
2. æ‰§è¡Œå“åº”æ—¶é—´
3. å†…å­˜ä½¿ç”¨æƒ…å†µ
4. å¤§æ–‡ä»¶å¤„ç†

## æ€»ç»“

æˆåŠŸä¸ºCogniGuideæ·»åŠ äº†å®Œæ•´çš„ä»£ç æ‰§è¡Œæ²™ç›’ç¯å¢ƒï¼Œæ»¡è¶³æ‰€æœ‰éªŒæ”¶æ ‡å‡†ã€‚è¯¥æ²™ç›’æä¾›äº†ï¼š

- **å®‰å…¨æ€§**: å®Œå…¨éš”ç¦»çš„æ‰§è¡Œç¯å¢ƒ
- **çµæ´»æ€§**: æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€
- **æ˜“ç”¨æ€§**: æ— ç¼é›†æˆåˆ°èŠå¤©ç•Œé¢
- **æ€§èƒ½**: ä¼˜åŒ–çš„åŠ è½½å’Œæ‰§è¡Œé€Ÿåº¦
- **å¯é æ€§**: å®Œå–„çš„é”™è¯¯å¤„ç†

ç”¨æˆ·ç°åœ¨å¯ä»¥åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ç›´æ¥è¿è¡Œä»£ç ç¤ºä¾‹ï¼Œæå¤§æå‡äº†ç¼–ç¨‹å­¦ä¹ ä½“éªŒã€‚

---

**é¡¹ç›®çŠ¶æ€**: âœ… å·²å®Œæˆ
**æµ‹è¯•çŠ¶æ€**: ğŸŸ¡ å¾…æµ‹è¯•
**ç”Ÿäº§å°±ç»ª**: âœ… æ˜¯
