# CogniGuide 学习分析仪表板

## 概述

学习分析仪表板是一个comprehensive的学习数据可视化工具，帮助用户深入了解他们的学习进度、效果和模式。

## 功能特性

### 1. 学习统计卡片
- **总学习时长**: 所有会话的累计学习时间（自动估算）
- **学习会话数**: 总共进行的学习会话次数
- **知识点数量**: 累计学习的知识点总数
- **平均掌握度**: 所有知识点的平均掌握程度百分比

### 2. 可视化图表

#### 概览标签页
- **知识掌握分布饼图**: 显示专家、熟练、新手、未知四个等级的分布
- **学习阶段分布柱状图**: 展示5个教学阶段（引入探索、构建理解、巩固练习、迁移应用、反思评价）的分布情况
- **快速统计卡片**: 活跃主题数、总消息数、平均会话时长

#### 趋势分析标签页
- **学习时长趋势图**: 最近14天的学习时长变化（折线图）
- **每日会话数量**: 最近14天的每日会话数（柱状图）
- **学习时段分布**: 24小时内的学习活跃度热力图（柱状图）
- **知识点积累趋势**: 最近14天新学习的知识点数量变化（折线图）

#### 智能洞察标签页
- **个性化学习洞察**: 基于数据自动生成的学习建议
  - 💪 学习强项识别
  - 📝 待提升领域提示
  - 💡 学习建议和优化建议
  - 🏆 成就和里程碑
- **学习强项分析**: 专家级知识点统计
- **待提升领域**: 新手级知识点统计

#### 成就标签页
- **成就系统**: 10个可解锁的成就
  - 🎯 初学者: 完成第一次学习会话
  - 📚 勤奋学习者: 完成10次学习会话
  - 🏆 学习达人: 完成50次学习会话
  - 💡 知识收集者: 掌握50个知识点
  - 🌟 知识大师: 掌握100个知识点
  - 🎓 专家之路: 10个知识点达到专家水平
  - 🔥 坚持不懈: 连续7天学习
  - ⏰ 专注一小时: 单次学习超过60分钟
  - ⏳ 学习积累: 累计学习达到5小时
  - 🎨 完整学习者: 经历所有5个学习阶段
- **进度追踪**: 每个未解锁成就显示完成进度

### 3. 时间范围筛选器
支持四个时间范围：
- **今天**: 最近24小时的学习数据
- **本周**: 最近7天的学习数据
- **本月**: 最近30天的学习数据
- **全部**: 所有历史学习数据

### 4. 导出学习报告
- 一键导出详细的学习分析报告（.txt格式）
- 报告包含：统计数据、掌握分布、学习洞察、已解锁成就
- 支持分享和存档

## 技术实现

### 依赖项
```json
{
  "recharts": "^2.x",
  "@types/recharts": "^2.x"
}
```

### 核心文件
1. **components/LearningAnalytics.tsx**
   - 主仪表板组件
   - 包含4个标签页的UI
   - 集成Recharts图表

2. **utils/analyticsHelpers.ts**
   - 数据聚合和分析函数
   - 时间序列处理
   - 成就系统逻辑
   - 报告导出功能

### 数据处理流程
```
localStorage中的所有会话数据
    ↓
按时间范围过滤
    ↓
计算统计数据
    ↓
生成可视化数据
    ↓
渲染图表和洞察
```

## 使用方法

### 访问学习分析

1. 在CogniGuide主界面，右侧"学习仪表板"标题旁
2. 点击图表图标（📊）按钮
3. 打开学习分析仪表板

### 导航仪表板

1. **顶部标签**: 切换不同视图
   - 概览: 查看整体统计
   - 趋势分析: 查看时间趋势
   - 智能洞察: 查看个性化建议
   - 成就: 查看已解锁和待解锁成就

2. **时间范围选择器**: 顶部的"今天/本周/本月/全部"按钮
   - 切换时间范围后，所有数据和图表会自动更新

3. **导出报告**: 点击右上角"导出报告"按钮
   - 自动下载.txt格式的学习报告

### 学习时长估算

系统使用以下算法估算学习时长：
- 使用每个会话的第一条和最后一条消息的时间戳
- 计算时间差并转换为分钟
- 每个会话最少记为1分钟

### 成就解锁条件

成就会在以下情况自动解锁：
- **会话相关**: 完成指定次数的学习会话
- **知识点相关**: 掌握指定数量的知识点
- **专家相关**: 指定数量知识点达到专家水平
- **连续学习**: 每天学习计算连续天数
- **时长相关**: 单次或累计学习时长达标
- **阶段相关**: 经历过所有5个学习阶段

## 数据来源

所有数据来自localStorage中的`cogniguide_sessions`：
- 每个SavedSession包含学习状态、消息历史、时间戳等
- 知识点掌握度来自learningState.concepts
- 学习阶段来自learningState.currentStage
- 会话时间来自lastModified和messages的时间戳

## 设计特色

### UI/UX
- **响应式设计**: 支持桌面、平板、移动设备
- **Tailwind CSS**: 与CogniGuide主界面风格一致
- **渐变和阴影**: 现代化的视觉设计
- **动画过渡**: 流畅的交互体验

### 色彩方案
- **Indigo/Blue**: 主色调，代表知识和学习
- **Emerald**: 成功、专家级别
- **Amber**: 警告、新手级别
- **Purple**: 成就、里程碑

### 性能优化
- **useMemo**: 缓存计算结果，避免重复计算
- **过滤后计算**: 先过滤数据再进行聚合分析
- **图表懒加载**: 只渲染当前可见的图表

## 扩展可能性

### 未来可添加的功能
1. **知识图谱热力图**: 展示不同领域的学习分布
2. **学习路径可视化**: 显示知识点之间的学习路径
3. **同伴对比**: 与其他学习者的数据对比
4. **学习目标设定**: 设置和追踪学习目标
5. **复习提醒**: 基于遗忘曲线的复习提醒
6. **学习效率评分**: 综合评估学习效率
7. **导出PDF报告**: 生成PDF格式的可视化报告
8. **数据同步**: 云端备份和跨设备同步

## 故障排除

### 常见问题

**Q: 为什么某些图表没有数据？**
A: 可能是因为选择的时间范围内没有学习会话，或者会话数据不完整。尝试切换到"全部"时间范围。

**Q: 学习时长计算准确吗？**
A: 系统使用消息时间戳估算，实际学习时长可能略有差异。建议作为参考指标。

**Q: 成就是如何解锁的？**
A: 成就基于会话数据自动计算，每次打开分析仪表板时会重新检查所有成就。

**Q: 可以导出更多格式的报告吗？**
A: 当前支持.txt格式，未来可能会添加PDF、JSON等格式。

**Q: 数据会自动保存吗？**
A: 是的，所有数据都来自localStorage，不需要额外保存。

## 开发者信息

### 代码结构
```
CogniGuide/
├── components/
│   └── LearningAnalytics.tsx    # 主组件
├── utils/
│   └── analyticsHelpers.ts      # 分析工具函数
└── App.tsx                      # 集成入口
```

### API参考

#### analyticsHelpers.ts主要函数

```typescript
// 过滤会话
filterSessionsByTimeRange(sessions, timeRange)

// 计算统计数据
calculateLearningStats(sessions): LearningStats

// 按天分组
groupByDay(sessions): DailyStats[]

// 掌握度分布
calculateMasteryDistribution(sessions): MasteryDistribution[]

// 阶段分布
calculateStageDistribution(sessions): StageDistribution[]

// 时间模式分析
analyzeTimePatterns(sessions): TimeOfDayPattern[]

// 生成洞察
generateInsights(sessions, stats, masteryDist, timePatterns): LearningInsight[]

// 检查成就
checkAchievements(sessions, stats): Achievement[]

// 导出报告
exportLearningReport(stats, timeRange, masteryDist, insights, achievements): string
```

## 版本历史

### v1.0.0 (当前版本)
- 初始发布
- 实现4个主要标签页
- 10个成就系统
- 多时间范围筛选
- 报告导出功能

---

**享受您的学习之旅！** 🎓✨

如有任何问题或建议，欢迎反馈！
